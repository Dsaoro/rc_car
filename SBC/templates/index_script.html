<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Final project - Telecomunications 2 </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="joy.js"></script>
</head>
  <body>
    <nav class="navbar bg-body-tertiary">
        <div class="container">
          <a class="navbar-brand" href="#">
            <img src="icon.png" alt="FPV Rover" width="35" height="35"> FPV Rover
          </a>
          <a href="#"></a>
        </div>
      </nav>
    <div class="container-fluid" style="background: linear-gradient(90deg, rgb(212, 214, 185) 0%, rgba(102,113,126,1) 35%, rgba(56,59,83,1) 100%);">
        <div class="row" style="padding: 10px;">
            <div class="col-md-8">
            <center>
                <img src="stream.webp" style="height: 480px;"></img>
            </center>
            </div>
            <div class="col-md-4 align-self-center" style="height: 400px; background-color: rgba(20,30,30,0.6);">
                <center>
                <center>
                    <div id="joy1Div" style="width:200px;height:200px;margin:50px">
                    </div>
                    Posizione X:<input id="joy1PosizioneX" type="text"/><br />
                    Posizione Y:<input id="joy1PosizioneY" type="text" /><br />
                    Direzione:<input id="joy1Direzione" type="text" /><br />
                    <form method="POST">
                        X :<input id="joy1X" name="xPos" type="text" oninput="enviarFormulario()" /></br>
                        Y :<input id="joy1Y" name="yPos" type="text" oninput="enviarFormulario()"/>
                    </form>
                </center>
                <div class="row">
                    
                    <div class="col-4">
                        <center>
                            <button type="button" class="btn btn-outline-warning"><</button>
                        </center>
                    </div>
                    <div class="col-4">
                        <center>
                            <button type="button" class="btn btn-outline-danger">&#9651;</button>
                        </center>
                    </div>
                    <div class="col-4">
                        <center>
                            <button type="button" class="btn btn-outline-warning">></button>
                        </center>
                    </div>
                </div>
                </center>
            </div>
        </div>

    </div>
    <div class="container">
        <footer class="py-3 my-4">
            <ul class="nav justify-content-center border-bottom pb-3 mb-3">
                <li class="nav-item">
                    <a class="nav-link px-2 text-muted" href="https://github.com/Johnatanvq"><img src="github.png" alt="github" width="20" height="20">Johnatavq</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link px-2 text-muted"  href="https://github.com/Dsaoro"><img src="github.png" alt="github" width="20" height="20"> Dsaoro</a>
                </li>
            </ul>

        </footer>
    </div>
    
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script type="text/javascript">
        // Create JoyStick object into the DIV 'joy1Div'
        //var Joy1 = new JoyStick('joy1Div');
        
        var joy1IinputPosX = document.getElementById("joy1PosizioneX");
        var joy1InputPosY = document.getElementById("joy1PosizioneY");
        var joy1Direzione = document.getElementById("joy1Direzione");
        var joy1X = document.getElementById("joy1X");
        var joy1Y = document.getElementById("joy1Y");
        /*
        setInterval(function(){ joy1IinputPosX.value=Joy1.GetPosX(); }, 50);
        setInterval(function(){ joy1InputPosY.value=Joy1.GetPosY(); }, 50);
        setInterval(function(){ joy1Direzione.value=Joy1.GetDir(); }, 50);
        setInterval(function(){ joy1X.value=Joy1.GetX(); }, 50);
        setInterval(function(){ joy1Y.value=Joy1.GetY(); }, 50);
        */
        // Create JoyStick object into the DIV 'joy1Div'
        var Joy1 = new JoyStick('joy1Div', {}, function(stickData) {
            joy1IinputPosX.value = stickData.xPosition;
            joy1InputPosY.value = stickData.yPosition;
            joy1Direzione.value = stickData.cardinalDirection;
            joy1X.value = stickData.x;
            joy1Y.value = stickData.y;
        });   
        
        
        function enviarFormulario() {
            var joy1XValue = document.getElementById("joy1X").value;
            var joy1YValue = document.getElementById("joy1Y").value;

            var formData = new FormData();
            formData.append('xPos', joy1XValue);
            formData.append('yPos', joy1YValue);

            fetch('/ponerrutaservidor', {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json()) 
            .then(data => {
                console.log(data);
            })
            .catch(error => {
                console.error('Error al enviar el formulario:', error);
            });
        }

    </script> 
  </body>
</html>